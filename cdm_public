import requests
import csv

def main():
    try:
        base_url = "https://www.space-track.org"
        auth_path = "/ajaxauth/login"
        user_name = "phil@holdstock.co.nz"
        password = "FatherDougal123*
        query = f"/basicspacedata/query/class/cdm_public/CDM_ID/CREATED/%3Enow-30/TCA/MIN_RNG/PC/SAT_1_ID/SAT_1_NAME/SAT_1_OBJECT_TYPE/SAT1_RCS/SAT_1_EXCL_VOL/SAT_2_ID/SAT_2_NAME/SAT_2_OBJECT_TYPE/SAT2_RCS/SAT_2_EXCL_VOL/format/csv"

        session = requests.Session()
        session.post(base_url + auth_path, data={"identity": user_name, "password": password})

        response = session.get(base_url + query)
        
        with open("spacetrack_TLE.txt", "w") as file:
            file.write(response.text)

        session.get(base_url + "/ajaxauth/logout")

    except Exception as e:
        print(e)


if __name__ == "__main__":
    main()
